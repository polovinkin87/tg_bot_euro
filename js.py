# a = [Update(update_id=820944759, message=None, edited_message=None, channel_post=None, edited_channel_post=None,
#             business_connection=None, business_message=None, edited_business_message=None,
#             deleted_business_messages=None, message_reaction=None, message_reaction_count=None, inline_query=None,
#             chosen_inline_result=None, callback_query=CallbackQuery(id='5421683349623298661',
#                                                                     from_user=User(id=1262334023, is_bot=False,
#                                                                                    first_name='Maksim',
#                                                                                    last_name='Polovinkin',
#                                                                                    username=None, language_code='ru',
#                                                                                    is_premium=None,
#                                                                                    added_to_attachment_menu=None,
#                                                                                    can_join_groups=None,
#                                                                                    can_read_all_group_messages=None,
#                                                                                    supports_inline_queries=None,
#                                                                                    can_connect_to_business=None),
#                                                                     chat_instance='-7966508044273404080',
#                                                                     message=Message(message_id=720,
#                                                                                     date=datetime.datetime(2024, 5, 16,
#                                                                                                            7, 26, 29,
#                                                                                                            tzinfo=TzInfo(
#                                                                                                                UTC)),
#                                                                                     chat=Chat(id=1262334023,
#                                                                                               type='private',
#                                                                                               title=None, username=None,
#                                                                                               first_name='Maksim',
#                                                                                               last_name='Polovinkin',
#                                                                                               is_forum=None,
#                                                                                               accent_color_id=None,
#                                                                                               active_usernames=None,
#                                                                                               available_reactions=None,
#                                                                                               background_custom_emoji_id=None,
#                                                                                               bio=None, birthdate=None,
#                                                                                               business_intro=None,
#                                                                                               business_location=None,
#                                                                                               business_opening_hours=None,
#                                                                                               can_set_sticker_set=None,
#                                                                                               custom_emoji_sticker_set_name=None,
#                                                                                               description=None,
#                                                                                               emoji_status_custom_emoji_id=None,
#                                                                                               emoji_status_expiration_date=None,
#                                                                                               has_aggressive_anti_spam_enabled=None,
#                                                                                               has_hidden_members=None,
#                                                                                               has_private_forwards=None,
#                                                                                               has_protected_content=None,
#                                                                                               has_restricted_voice_and_video_messages=None,
#                                                                                               has_visible_history=None,
#                                                                                               invite_link=None,
#                                                                                               join_by_request=None,
#                                                                                               join_to_send_messages=None,
#                                                                                               linked_chat_id=None,
#                                                                                               location=None,
#                                                                                               message_auto_delete_time=None,
#                                                                                               permissions=None,
#                                                                                               personal_chat=None,
#                                                                                               photo=None,
#                                                                                               pinned_message=None,
#                                                                                               profile_accent_color_id=None,
#                                                                                               profile_background_custom_emoji_id=None,
#                                                                                               slow_mode_delay=None,
#                                                                                               sticker_set_name=None,
#                                                                                               unrestrict_boost_count=None),
#                                                                                     message_thread_id=None,
#                                                                                     from_user=User(id=6642199188,
#                                                                                                    is_bot=True,
#                                                                                                    first_name='Bot_Euro_24',
#                                                                                                    last_name=None,
#                                                                                                    username='Euro_24_bot',
#                                                                                                    language_code=None,
#                                                                                                    is_premium=None,
#                                                                                                    added_to_attachment_menu=None,
#                                                                                                    can_join_groups=None,
#                                                                                                    can_read_all_group_messages=None,
#                                                                                                    supports_inline_queries=None,
#                                                                                                    can_connect_to_business=None),
#                                                                                     sender_chat=None,
#                                                                                     sender_boost_count=None,
#                                                                                     sender_business_bot=None,
#                                                                                     business_connection_id=None,
#                                                                                     forward_origin=None,
#                                                                                     is_topic_message=None,
#                                                                                     is_automatic_forward=None,
#                                                                                     reply_to_message=None,
#                                                                                     external_reply=None, quote=None,
#                                                                                     reply_to_story=None, via_bot=None,
#                                                                                     edit_date=None,
#                                                                                     has_protected_content=None,
#                                                                                     is_from_offline=None,
#                                                                                     media_group_id=None,
#                                                                                     author_signature=None, text=None,
#                                                                                     entities=None,
#                                                                                     link_preview_options=None,
#                                                                                     animation=None, audio=None,
#                                                                                     document=None, photo=[PhotoSize(
#                                                                             file_id='AgACAgIAAxkDAAIC0GZFtSWz_PzTdiBk0hNf9vmqrHG7AAKR3DEbBAXpSeX94aZgtK50AQADAgADcwADNQQ',
#                                                                             file_unique_id='AQADkdwxGwQF6Ul4', width=90,
#                                                                             height=70, file_size=1333), PhotoSize(
#                                                                             file_id='AgACAgIAAxkDAAIC0GZFtSWz_PzTdiBk0hNf9vmqrHG7AAKR3DEbBAXpSeX94aZgtK50AQADAgADbQADNQQ',
#                                                                             file_unique_id='AQADkdwxGwQF6Uly',
#                                                                             width=320, height=249, file_size=13913),
#                                                                                                           PhotoSize(
#                                                                                                               file_id='AgACAgIAAxkDAAIC0GZFtSWz_PzTdiBk0hNf9vmqrHG7AAKR3DEbBAXpSeX94aZgtK50AQADAgADeAADNQQ',
#                                                                                                               file_unique_id='AQADkdwxGwQF6Ul9',
#                                                                                                               width=800,
#                                                                                                               height=622,
#                                                                                                               file_size=46891),
#                                                                                                           PhotoSize(
#                                                                                                               file_id='AgACAgIAAxkDAAIC0GZFtSWz_PzTdiBk0hNf9vmqrHG7AAKR3DEbBAXpSeX94aZgtK50AQADAgADeQADNQQ',
#                                                                                                               file_unique_id='AQADkdwxGwQF6Ul-',
#                                                                                                               width=1280,
#                                                                                                               height=996,
#                                                                                                               file_size=64635)],
#                                                                                     sticker=None, story=None,
#                                                                                     video=None, video_note=None,
#                                                                                     voice=None, caption=None,
#                                                                                     caption_entities=None,
#                                                                                     has_media_spoiler=None,
#                                                                                     contact=None, dice=None, game=None,
#                                                                                     poll=None, venue=None,
#                                                                                     location=None,
#                                                                                     new_chat_members=None,
#                                                                                     left_chat_member=None,
#                                                                                     new_chat_title=None,
#                                                                                     new_chat_photo=None,
#                                                                                     delete_chat_photo=None,
#                                                                                     group_chat_created=None,
#                                                                                     supergroup_chat_created=None,
#                                                                                     channel_chat_created=None,
#                                                                                     message_auto_delete_timer_changed=None,
#                                                                                     migrate_to_chat_id=None,
#                                                                                     migrate_from_chat_id=None,
#                                                                                     pinned_message=None, invoice=None,
#                                                                                     successful_payment=None,
#                                                                                     users_shared=None, chat_shared=None,
#                                                                                     connected_website=None,
#                                                                                     write_access_allowed=None,
#                                                                                     passport_data=None,
#                                                                                     proximity_alert_triggered=None,
#                                                                                     boost_added=None,
#                                                                                     chat_background_set=None,
#                                                                                     forum_topic_created=None,
#                                                                                     forum_topic_edited=None,
#                                                                                     forum_topic_closed=None,
#                                                                                     forum_topic_reopened=None,
#                                                                                     general_forum_topic_hidden=None,
#                                                                                     general_forum_topic_unhidden=None,
#                                                                                     giveaway_created=None,
#                                                                                     giveaway=None,
#                                                                                     giveaway_winners=None,
#                                                                                     giveaway_completed=None,
#                                                                                     video_chat_scheduled=None,
#                                                                                     video_chat_started=None,
#                                                                                     video_chat_ended=None,
#                                                                                     video_chat_participants_invited=None,
#                                                                                     web_app_data=None,
#                                                                                     reply_markup=InlineKeyboardMarkup(
#                                                                                         inline_keyboard=[[
#                                                                                                              InlineKeyboardButton(
#                                                                                                                  text='Прогнозы 🎲',
#                                                                                                                  url=None,
#                                                                                                                  callback_data='menu:1:forecasts::1:',
#                                                                                                                  web_app=None,
#                                                                                                                  login_url=None,
#                                                                                                                  switch_inline_query=None,
#                                                                                                                  switch_inline_query_current_chat=None,
#                                                                                                                  switch_inline_query_chosen_chat=None,
#                                                                                                                  callback_game=None,
#                                                                                                                  pay=None),
#                                                                                                              InlineKeyboardButton(
#                                                                                                                  text='Турнирная таблица 📊',
#                                                                                                                  url=None,
#                                                                                                                  callback_data='menu:1:table::1:',
#                                                                                                                  web_app=None,
#                                                                                                                  login_url=None,
#                                                                                                                  switch_inline_query=None,
#                                                                                                                  switch_inline_query_current_chat=None,
#                                                                                                                  switch_inline_query_chosen_chat=None,
#                                                                                                                  callback_game=None,
#                                                                                                                  pay=None)],
#                                                                                                          [
#                                                                                                              InlineKeyboardButton(
#                                                                                                                  text='Календарь 🗓️',
#                                                                                                                  url=None,
#                                                                                                                  callback_data='menu:1:calendar::1:',
#                                                                                                                  web_app=None,
#                                                                                                                  login_url=None,
#                                                                                                                  switch_inline_query=None,
#                                                                                                                  switch_inline_query_current_chat=None,
#                                                                                                                  switch_inline_query_chosen_chat=None,
#                                                                                                                  callback_game=None,
#                                                                                                                  pay=None),
#                                                                                                              InlineKeyboardButton(
#                                                                                                                  text='Статистика 📌',
#                                                                                                                  url=None,
#                                                                                                                  callback_data='menu:1:statistics::1:',
#                                                                                                                  web_app=None,
#                                                                                                                  login_url=None,
#                                                                                                                  switch_inline_query=None,
#                                                                                                                  switch_inline_query_current_chat=None,
#                                                                                                                  switch_inline_query_chosen_chat=None,
#                                                                                                                  callback_game=None,
#                                                                                                                  pay=None)],
#                                                                                                          [
#                                                                                                              InlineKeyboardButton(
#                                                                                                                  text='Правила ❗️',
#                                                                                                                  url=None,
#                                                                                                                  callback_data='menu:1:rules::1:',
#                                                                                                                  web_app=None,
#                                                                                                                  login_url=None,
#                                                                                                                  switch_inline_query=None,
#                                                                                                                  switch_inline_query_current_chat=None,
#                                                                                                                  switch_inline_query_chosen_chat=None,
#                                                                                                                  callback_game=None,
#                                                                                                                  pay=None)]]),
#                                                                                     forward_date=None,
#                                                                                     forward_from=None,
#                                                                                     forward_from_chat=None,
#                                                                                     forward_from_message_id=None,
#                                                                                     forward_sender_name=None,
#                                                                                     forward_signature=None,
#                                                                                     user_shared=None),
#                                                                     inline_message_id=None, data='menu:1:forecasts::1:',
#                                                                     game_short_name=None), shipping_query=None,
#             pre_checkout_query=None, poll=None, poll_answer=None, my_chat_member=None, chat_member=None,
#             chat_join_request=None, chat_boost=None, removed_chat_boost=None)]

def _get_part_text(text: str, start: int, page_size: int):
    result = text[start: start + page_size]
    end = 0
    znaki = [',', '.', '!', '?', ':', ';']
    for i in reversed(range(len(result))):
        if result[i] in znaki:
            if i + start + 1 < len(text):
                if text[i + start + 1] not in znaki:
                    end = i
                    break
            else:
                end = i
                break
    return result[:end + 1], end + 1


# text = 'Да? Вы точно уверены? Может быть, вам это показалось?.. Ну, хорошо, приходите завтра, тогда и посмотрим, что можно сделать. И никаких возражений! Завтра, значит, завтра!'

# print(*_get_part_text(text, 0, 54), sep='\n')

book = {}


def prepare_book(path: str) -> None:
    with open(path, 'r', encoding='utf-8') as b:
        txt = b.read()
        k = 0
        n = 1
        while k < len(txt):
            s, l = _get_part_text(txt, k, 1050)
            book.update({n: s.lstrip()})
            n += 1
            k += l


prepare_book('book.txt')
